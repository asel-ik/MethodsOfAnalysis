---
title: "Does Black Saber Software's Human Resources department use biased systems?"
author: "Report prepared for Black Saber Software by Core Data Consultancy"
date: '2021-04-21'
output:
  pdf_document:
    template: report.tex
    toc: yes
    toc_depth: 2
  html_document:
    toc: yes
    toc_depth: '2'
    df_print: paged
lang: en
subtitle: Report on potential bias in hiring and remuneration processes at Black Saber
  Software
titlepage: yes
titlepage-color: 83A5BA
titlepage-text-color: FFFFFF
titlepage-rule-color: FFFFFF
titlepage-rule-height: 2
---

```{r, message = FALSE, echo=FALSE}
library(tidyverse)
# this should supress all code and messages
knitr::opts_chunk$set(include=FALSE, echo = TRUE, warning = FALSE, eval = TRUE)
```

# General comments (you can delete this section)

_You can delete this section, and if you want to check what it said, just open a template from the package again. You don't have to use this particular template, but you DO need to write you report in RMarkdown and include a cover page._

_The cover page must have:_

*	_A title and subtitle_
* _"Report prepared for Black Saber Software by" your company name_
*	_Date (assessment submission date is fine)_

_You can change the colour of this cover to any colour you would like by replacing 6C3082 in the YAML above (line 11) to another hex code. You could use this tool to help you:_ https://htmlcolorcodes.com/color-picker/

\newpage
# Executive summary

_Guidelines for the executive summary:_

* _No more than two pages_
* _Language is appropriate for a non-technical audience_
* _Bullet points are used where appropriate_
*	_A small number of key visualizations and/or tables are included_
*	_All three research questions are addressed_


\newpage
# Technical report
_This part of the report is much more comprehensive than the executive summary. The audience is statistics/data-minded people, but you should NOT include code or unformatted R output here._


## Introduction

_Provide a brief introduction to your report and outline what the report will cover. This section is valuable for setting scope and expectations. _

### Research questions
_Use bullet points to to describe the research questions you are going to address. Write in full sentences._

## Is the artificial intellegence used in hiring process introduces preferences toward a particular group of people?

_For each research question, you will want to briefly describe any data manipulation, show some exploratory plots/summary tables, report on any methods you use (i.e. models you fit) and the conclusions you draw from these_

```{r, include = FALSE}
library(tidyverse)
library(lme4)
```

```{r, include = FALSE}
ph1_appl <- read_csv("data/phase1-new-grad-applicants-2020.csv")
ph2_appl <- read_csv("data/phase2-new-grad-applicants-2020.csv")
ph3_appl <- read_csv("data/phase3-new-grad-applicants-2020.csv")

```

### Phase 1 EDA
```{r}
library(ggpubr)
# Gender distr.
ph1_gen <- ph1_appl %>% 
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = gender, fill = gender)) +
  geom_bar(color = "gray") +
  theme_minimal() +
  labs(caption = "Gender distribution", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D")) +
  theme(legend.position = 0)+
  lims(y = c(0, 400))

# save your plot in your images folder, you can specify the height and width, too

#ggsave("images/gender.png", width = 7, height = 4)
```


```{r}
# Team applied for
ph1_gen_team <- ph1_appl %>% 
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  #pivot_wider(names_from = gender, values_from = gpa) %>% 
  ggplot(aes(x = team_applied_for, fill = gender)) +
  geom_histogram(color = "gray", stat = "count") +
  theme_minimal() +
  labs(caption = "Team", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D")) +
  lims(y = c(0, 400)) +
  theme(legend.title = element_blank(),
        legend.position = c(.15, .8))

fig_g_t_ph1 <- ggarrange(ph1_gen, ph1_gen_team,
                    ncol = 2, nrow = 1,
                    common.legend = TRUE)
fig_g_t_ph1
# save your plot in your images folder, you can specify the height and width, too

#ggsave("images/gpa.png", width = 7, height = 4)
```


```{r}
# Extracur -Gender
ph1_gen_extracur <- ph1_appl %>% 
  #mutate(extracurriculars = as.factor(extracurriculars)) %>% 
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>%
  ggplot(aes(x = extracurriculars, fill = gender)) +
  geom_bar(color = "gray") +
  theme_minimal() +
  labs(caption = "Extracurricular", x = " ", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 500))+
  theme(legend.title = element_blank(),
        legend.position = c(.15, .8))

# save your plot in your images folder:
ggsave("images/extracur_gen.png", width = 7, height = 4)

```



```{r}
# Work exp - Gender
ph1_gen_workexp <- ph1_appl %>% 
  mutate(applicant_id = as.factor(applicant_id)) %>%
  mutate(work_experience = as.factor(work_experience)) %>%
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = work_experience, fill = gender)) +
  geom_bar(color = "gray") +
  theme_minimal() +
  labs(caption = "Work exp", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 500))+
  theme(legend.title = element_blank(),
        legend.position = c(.15, .8))

# save your plot in your images folder, you can specify the height and width, too

ggsave("images/work_gen.png", width = 7, height = 4)

fig_e_w_ph1 <- ggarrange(ph1_gen_extracur, ph1_gen_workexp,
                    ncol = 2, nrow = 1,
                    common.legend = TRUE)
fig_e_w_ph1

#ggsave("images/work_gen.png", width = 7, height = 4)
```




```{r}
# GPA
ph1_gen_gpa <- ph1_appl %>% 
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = gpa, fill = gender)) +
  geom_histogram(color = "gray") +
  theme_minimal() +
  labs(caption = "GPA", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 25))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) +
  facet_wrap(~gender)
ph1_gen_gpa


# save your plot in your images folder, you can specify the height and width, too

ggsave("images/gpa.png", width = 7, height = 4)
```


![GPA by gender](images/gpa.png)

```{r}
# # GPA - Man:
# ph1_gpa_m <- ph1_appl %>% 
#   mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
#   pivot_wider(names_from = gender, values_from = gpa) %>% 
#   ggplot(aes(x = `Man`)) +
#   geom_histogram(fill = "#83A5BA", color = "gray") +
#   theme_minimal() +
#   labs(caption = "GPA", x = "", y = "")+
#   lims(y = c(0, 20))
#   # scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))
# ph1_gpa_m
# 
# #GPA - Woman
# ph1_gpa_w <- ph1_appl %>% 
#   mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
#   pivot_wider(names_from = gender, values_from = gpa) %>% 
#   ggplot(aes(x = `Woman`)) +
#   geom_histogram(fill = "#86BCB6", color = "gray") +
#   theme_minimal() +
#   labs(caption = "GPA", x = "", y = "")+
#   lims(y = c(0, 25))
#   # scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))
# ph1_gpa_w
# 
# #GPA - Prefer not to say
# ph1_gpa_p <- ph1_appl %>% 
#   mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
#   pivot_wider(names_from = gender, values_from = gpa) %>% 
#   ggplot(aes(x = `Prefer not to say`)) +
#   geom_histogram(fill = "#B9CA5D", color = "gray") +
#   theme_minimal() +
#   labs(caption = "GPA", x = "", y = "")
#   # scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))
# ph1_gpa_p
```



### Phase 2 EDA

```{r}
# Gender distr.
ph2_gen <- ph2_appl %>% 
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = gender, fill = gender)) +
  geom_bar(color = "gray") +
  theme_minimal() +
  labs(caption = "Gender distribution - phase2", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D")) +
  theme(legend.title = element_blank()) +
  lims(y = c(0, 200))
# save your plot in your images folder, you can specify the height and width, too

# ggsave("images/gender.png", width = 7, height = 4)
```



```{r}
# Team applied for
ph2_gen_team <- ph2_appl %>% 
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  #pivot_wider(names_from = gender, values_from = gpa) %>% 
  ggplot(aes(x = team_applied_for, fill = gender)) +
  geom_histogram(color = "gray", stat = "count") +
  theme_minimal() +
  labs(caption = "Team - phase2", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D")) +
  lims(y = c(0, 200)) +
  theme(legend.title = element_blank(),
        legend.position = c(.15, .8))


fig_g_t_ph2 <- ggarrange(ph2_gen, ph2_gen_team,
                    ncol = 2, nrow = 1,
                    common.legend = TRUE)
fig_g_t_ph2
# save your plot in your images folder, you can specify the height and width, too

#ggsave("images/gpa.png", width = 7, height = 4)
```

```{r}
# GPA


ph2_gen_gpa <- ph2_appl %>% 
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  #pivot_wider(names_from = gender, values_from = gpa) %>% 
  ggplot(aes(x = gpa, fill = gender)) +
  geom_histogram(color = "gray") +
  theme_minimal() +
  labs(caption = "GPA", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 20))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) +
  facet_wrap(~gender)
ph2_gen_gpa

# save your plot in your images folder, you can specify the height and width, too

#ggsave("images/gpa.png", width = 7, height = 4)
```

```{r}
# # GPA - Man:
# ph2_gpa_m <- ph2_appl %>% 
#   mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
#   pivot_wider(names_from = gender, values_from = gpa) %>% 
#   ggplot(aes(x = `Man`)) +
#   geom_histogram(fill = "#83A5BA", color = "gray") +
#   theme_minimal() +
#   labs(caption = "GPA", x = "", y = "")+
#   lims(y = c(0, 20))
#   # scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))
# ph2_gpa_m
# 
# #GPA - Woman
# ph2_gpa_w <- ph2_appl %>% 
#   mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
#   pivot_wider(names_from = gender, values_from = gpa) %>% 
#   ggplot(aes(x = `Woman`)) +
#   geom_histogram(fill = "#86BCB6", color = "gray") +
#   theme_minimal() +
#   labs(caption = "GPA", x = "", y = "")+
#   lims(y = c(0, 25))
#   # scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))
# ph2_gpa_w
# 
# #GPA - Prefer not to say
# ph2_gpa_p <- ph2_appl %>% 
#   mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
#   pivot_wider(names_from = gender, values_from = gpa) %>% 
#   ggplot(aes(x = `Prefer not to say`)) +
#   geom_histogram(fill = "#B9CA5D", color = "gray") +
#   theme_minimal() +
#   labs(caption = "GPA", x = "", y = "")
#   # scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))
# ph2_gpa_p
```


```{r}
# Extracur -Gender
ph2_gen_extracur <- ph2_appl %>% 
  mutate(extracurriculars = as.factor(extracurriculars)) %>% 
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>%
  ggplot(aes(x = extracurriculars, fill = gender)) +
  geom_bar(color = "gray") +
  theme_minimal() +
  labs(caption = "Extracurricular - phase2", x = " ", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 250))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8))


# save your plot in your images folder:
#ggsave("images/extracur_gen.png", width = 7, height = 4)

```


```{r}
# Work exp - Gender
ph2_gen_workexp <- ph2_appl %>% 
  mutate(applicant_id = as.factor(applicant_id)) %>%
  mutate(work_experience = as.factor(work_experience)) %>%
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = work_experience, fill = gender)) +
  geom_bar(color = "gray") +
  theme_minimal() +
  labs(caption = "Work exp-phase2", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 250))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8))

fig_e_w_ph2 <- ggarrange(ph2_gen_extracur, ph2_gen_workexp,
                    ncol = 2, nrow = 1,
                    common.legend = TRUE)
fig_e_w_ph2
# save your plot in your images folder, you can specify the height and width, too

ggsave("images/extra_work_gen.png", width = 7, height = 4)
```

![Extracurricular and work experience by gender - phase2](images/extra_work_gen.png)

```{r}
# Tech skills

ph2_tech <- ph2_appl %>% 
  #mutate(applicant_id = as.factor(applicant_id)) %>%
  #mutate(work_experience = as.factor(work_experience)) %>%
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = technical_skills, fill = gender)) +
  geom_histogram(color = "gray") +
  theme_minimal() +
  labs(caption = "Tech", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 15))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) +
  facet_wrap(~gender)
ph2_tech
# save your plot in your images folder, you can specify the height and width, too

#ggsave("images/work_gen.png", width = 7, height = 4)
```


```{r}
# Writing skills

ph2_writ <- ph2_appl %>% 
  #mutate(applicant_id = as.factor(applicant_id)) %>%
  #mutate(work_experience = as.factor(work_experience)) %>%
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = writing_skills, fill = gender)) +
  geom_histogram(color = "gray") +
  theme_minimal() +
  labs(caption = "Writing", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 20))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) +
  facet_wrap(~gender)
ph2_writ
# save your plot in your images folder, you can specify the height and width, too

#ggsave("images/work_gen.png", width = 7, height = 4)
```

```{r}
# Leadership

ph2_lead <- ph2_appl %>% 
  #mutate(applicant_id = as.factor(applicant_id)) %>%
  mutate(leadership_presence = as.factor(leadership_presence)) %>%
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = leadership_presence, fill = gender)) +
  geom_histogram(color = "gray", stat = "count") +
  theme_minimal() +
  labs(caption = "Writing", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 35))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) +
  facet_wrap(~gender)
ph2_lead
# save your plot in your images folder, you can specify the height and width, too

#ggsave("images/work_gen.png", width = 7, height = 4)
```

```{r}
# Speaking

ph2_speak <- ph2_appl %>% 
  #mutate(applicant_id = as.factor(applicant_id)) %>%
  mutate(speaking_skills = as.factor(speaking_skills)) %>%
  mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = speaking_skills, fill = gender)) +
  geom_histogram(color = "gray", stat="count") +
  theme_minimal() +
  labs(caption = "Writing", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(y = c(0, 30))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) +
  facet_wrap(~gender)
ph2_speak
# save your plot in your images folder, you can specify the height and width, too

#ggsave("images/work_gen.png", width = 7, height = 4)
```


### Phase 3 EDA

```{r}
# Find out applicants' gender for phase 3 dataset:

joined <- left_join(ph3_appl, ph2_appl)

```

```{r}

ph3_gender <- joined %>% 
  #mutate(applicant_id = as.factor(applicant_id)) %>%
  #mutate(speaking_skills = as.factor(speaking_skills)) %>%
  #mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = gender, fill = gender, color = team_applied_for)) +
  geom_histogram(stat = "count") +
  theme_minimal() +
  labs(caption = "Gender", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6"))+
  scale_color_manual(values = c("black", "red"))+
  #lims(y = c(0, 30))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8))
ph3_gender
```

```{r}
# Int 1 rating by gender
ph3_gen1 <- joined %>% 
  #mutate(applicant_id = as.factor(applicant_id)) %>%
  #mutate(speaking_skills = as.factor(speaking_skills)) %>%
  #mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = interviewer_rating_1, fill = gender)) +
  geom_histogram(color = "gray") +
  theme_minimal() +
  labs(caption = "Int1 by gender", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6"))+
  lims(x = c(60, 100))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) +
  facet_wrap(~gender)
ph3_gen1
```


```{r}
# Int 2 by gender

ph3_gen2 <- joined %>% 
  #mutate(applicant_id = as.factor(applicant_id)) %>%
  #mutate(speaking_skills = as.factor(speaking_skills)) %>%
  #mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = interviewer_rating_2, fill = gender)) +
  geom_histogram(color = "gray") +
  theme_minimal() +
  labs(caption = "Int1 by gender", x = "", y = "") +
  scale_fill_manual(values = c("#83A5BA", "#86BCB6"))+
  lims(x = c(60, 100))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) +
  facet_wrap(~gender)
ph3_gen2
```

```{r}
# Interviewer 1

ph3_int1 <- ph3_appl %>% 
  mutate(applicant_id = as.factor(applicant_id)) %>%
  #mutate(speaking_skills = as.factor(speaking_skills)) %>%
  #mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = interviewer_rating_1)) +
  geom_histogram() +
  theme_minimal() +
  labs(caption = "Int1", x = "", y = "") +
  #scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  #lims(y = c(0, 30))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) 
ph3_int1

# Appl ID - int1
ph3_int1_1 <- ph3_appl %>% 
  mutate(applicant_id = as.factor(applicant_id)) %>%
  #mutate(speaking_skills = as.factor(speaking_skills)) %>%
  #mutate(gender = fct_relevel(gender, "Prefer not to say", after = 2)) %>% 
  ggplot(aes(x = interviewer_rating_1, y = applicant_id)) +
  geom_col() +
  theme_minimal() +
  labs(caption = "Int1", x = "", y = "") +
  #scale_fill_manual(values = c("#83A5BA", "#86BCB6", "#B9CA5D"))+
  lims(x = c(0, 100))+
  theme(legend.title = element_blank(),
        legend.position = c(.8, .8)) 
ph3_int1_1


# save your plot in your images folder, you can specify the height and width, too

#ggsave("images/work_gen.png", width = 7, height = 4)
```

## Are the systems used for promoting employees free from bias?
## Is salary calculated appropriately and according to employees' work experience and performance?

```{r}
# This chunk provides an example of some things you can do with RMarkdown to make your report creation process easier

# read in the data
black_saber_current_employees <- read_csv("data/black-saber-current-employees.csv")

# create a visualisation
my_plot <- black_saber_current_employees %>% 
  ggplot(aes(x = productivity)) +
  geom_histogram(colour = "grey", fill = "#6C3082") +
  theme_minimal() +
  labs(title = "Look! A title. But do you want a title or a caption for your report?", x = "This is a changed x label")

# save your plot in your images folder, you can specify the height and width, too

ggsave("images/example.png", width = 7, height = 4)
```



## Discussion

_In this section you will summarize your findings across all the research questions and discuss the strengths and limitations of your work. It doesn't have to be long, but keep in mind that often people will just skim the intro and the discussion of a document like this, so make sure it is useful as a semi-standalone section (doesn't have to be completely standalone like the executive summary)._

### Strengths and limitations

\newpage
# Consultant information
## Consultant profile

**Asel Kushkeyeva**. Asel has been in an independent consultancy since 2021. Her firm, Core Data Consultancy, has been recognized among leading Canadian consultancies. In 2022, Asel has won a prestigious The Canadian Journal of Statistics Award. She specializes in reproducible analysis, statistical communication, and data visualization. Asel earned her Masters of Information, Specialist in Human-Centered Data Science, from the University of Toronto in 2021.

## Code of ethical conduct

**1. Professional Integrity and Accountability**

At Core Data Consultancy, professional conduct is the priority in all aspects of our work. We take pride in a high level of accountability at all times, striving to always accept our mistakes and ensuring minimized negative consequences for all stakeholders.

**2. Integrity of Data and Methods**

Continuously providing professional services, Core Data Consultancy strives for reproducibility of our work to further encourage development in science and data industry. In order to produce quality reports, we ensure data and statistical methods integrity.

**3. Responsibilities to Science, Public, and Client**

Being a noticeable/mature player in the area of independent statistical analysis, Core Data Consultancy holds itself responsible to science, public, and clients by adhering to science and industry ethical standards, considering public interests, and going above and beyond to keep clients' information secure at all times.

__Final advice: KNIT EARLY AND OFTEN!__